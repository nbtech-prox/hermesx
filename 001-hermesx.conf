<VirtualHost *:80>
        # Definir prioridade alta para este VirtualHost
        ServerName hermesx.nbserver.pt
        ServerAlias www.hermesx.nbserver.pt
        ServerAdmin nbtech.prox@gmail.com

        # Garantir que este VirtualHost seja usado para este domínio
        <If "%{HTTP_HOST} == 'hermesx.nbserver.pt' || %{HTTP_HOST} == 'www.hermesx.nbserver.pt'">
                DocumentRoot /var/www/html/hermesx

                # Configuração básica do Cloudflare
                SetEnvIf X-Forwarded-Proto https HTTPS=on

                WSGIDaemonProcess hermesx python-path=/var/www/html/hermesx:/var/www/html/hermesx/env/lib/python3.10/site-packages
                WSGIProcessGroup hermesx
                WSGIScriptAlias / /var/www/html/hermesx/run.wsgi

                <Directory /var/www/html/hermesx>
                        Require all granted
                        Options FollowSymLinks
                        AllowOverride None
                </Directory>

                <Directory /var/www/html/hermesx/.git>
                        Require all denied
                </Directory>

                <Directory /var/www/html/hermesx/.env>
                        Require all denied
                </Directory>

                <FilesMatch "\.(py|pyc|ini|log)$">
                        Require all denied
                </FilesMatch>

                <Location /static>
                        Require all granted
                </Location>
        </If>

        ErrorLog ${APACHE_LOG_DIR}/hermesx_error.log
        CustomLog ${APACHE_LOG_DIR}/hermesx_access.log combined
</VirtualHost>
